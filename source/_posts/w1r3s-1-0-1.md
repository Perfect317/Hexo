---
title: 红队打靶：w1r3s:1.0.1打靶记录
date: 2024-08-15 15:30:55
tags: 红队
categories: 红队打靶
---

# 信息收集

查看kali网段，然后使用nmap扫描该网段的主机，得到主机后扫描该主机开启的端口

![信息收集](./w1r3s-1-0-1/image-20240813133303563.png)

![image-20240813133336443](./w1r3s-1-0-1/image-20240813133336443.png)

得到主机192.168.204.130

21，22，80，3306端口开放

-sT表示进行TCP扫描（三握手），-p表示待扫描的端口（后跟待扫描的端口21，22，80，3306）-sV表示探测开放服务的版本，-O表示探测操作系统版本，扫描结果如下：

![image-20240813134436662](./w1r3s-1-0-1/image-20240813134436662.png)

在扫描UDP端口，显示3306关闭，其他打开/被过滤的状态

![image-20240813134558480](./w1r3s-1-0-1/image-20240813134558480.png)

使用nmap自带的漏扫工具进行漏洞扫描，-script=vuln参数

![image-20240813140134949](./w1r3s-1-0-1/image-20240813140134949.png)

![image-20240813140156996](./w1r3s-1-0-1/image-20240813140156996.png)

发现有dos攻击漏洞，在渗透方面作用不大，上面还有一个登录页面

# FTP渗透

先试试FTP能不能匿名登录，账号：anonymous，密码为空

![image-20240813141057308](./w1r3s-1-0-1/image-20240813141057308.png)

直接可以登录，逐个查看目录并且下载其中的文件，这里需要注意的是，如果目录下的文件不是文本.txt文件的话，需要先运行binary指令（即输入binary然后回车）转换为二进制格式，以保证通过FTP下载的文件不会损坏。如果本身就是txt文件，则运不运行binary都可。下载的命令是：mget 

![image-20240813141258620](./w1r3s-1-0-1/image-20240813141258620.png)

![image-20240813141331532](./w1r3s-1-0-1/image-20240813141331532.png)

![image-20240813141342997](./w1r3s-1-0-1/image-20240813141342997.png)

![image-20240813141402843](./w1r3s-1-0-1/image-20240813141402843.png)

![image-20240813141441763](./w1r3s-1-0-1/image-20240813141441763.png)

返回kali查看文件内容

![image-20240813141835888](./w1r3s-1-0-1/image-20240813141835888.png)

![image-20240813141817820](./w1r3s-1-0-1/image-20240813141817820.png)

使用hash-identifier识别是否是哈希

![image-20240813142101312](./w1r3s-1-0-1/image-20240813142101312.png)

MD5加密，使用在线网站解密,

```
https://hashes.com/en/decrypt/hash
```

![image-20240813142349625](./w1r3s-1-0-1/image-20240813142349625.png)

后面类似是base64

![image-20240813142430531](./w1r3s-1-0-1/image-20240813142430531.png)

然后查看下一个文件

![image-20240813142503818](./w1r3s-1-0-1/image-20240813142503818.png)

将照片倒过来,或者使用在线网站

```
https://www.upsidedowntext.com/
```



![image-20240813142607919](./w1r3s-1-0-1/image-20240813142607919.png)

![image-20240813142801241](./w1r3s-1-0-1/image-20240813142801241.png)

暗示我们要提权，获取root权限

查看emplyee文件，这是雇员信息，在web渗透时说不定有用

![image-20240813142923619](./w1r3s-1-0-1/image-20240813142923619.png)

# 80端口

直接访问靶机的ip试试，显示使用的是apache2的中间件

![image-20240813143042109](./w1r3s-1-0-1/image-20240813143042109.png)

然后扫目录看看能不能扫到其他页面，扫出administrator,javascript,wordpress页面，尝试访问

![image-20240813144048612](./w1r3s-1-0-1/image-20240813144048612.png)

访问administrator页面，这是cuppa cms的安装页面，暴露了一些配置信息

![image-20240813144217587](./w1r3s-1-0-1/image-20240813144217587.png)

访问javascript页面

![image-20240813144420546](./w1r3s-1-0-1/image-20240813144420546.png)

访问wordpress页面

![image-20240813144457164](./w1r3s-1-0-1/image-20240813144457164.png)

查找一下有没有cuppa这个cms的已知漏洞，使用kali的searchsploit查找

![image-20240813144720624](./w1r3s-1-0-1/image-20240813144720624.png)

下载下来查看如何使用，他说alertConfigFireld.php文件的22行这里有漏洞

![image-20240813144920801](./w1r3s-1-0-1/image-20240813144920801.png)

下面有说明如果利用该远程文件读取漏洞

![image-20240813145157405](./w1r3s-1-0-1/image-20240813145157405.png)

![image-20240813145533864](./w1r3s-1-0-1/image-20240813145533864.png)

无法读取到passwd,尝试访问不同页面

![image-20240813145936744](./w1r3s-1-0-1/image-20240813145936744.png)

![image-20240813145736158](./w1r3s-1-0-1/image-20240813145736158.png)

提交时进行url编码一下,这里尝试在hackbar中进行url编码后进行提交也是不行的，有大佬可以再尝试一下，使用curl进行url编码之后进行提交

```
curl --data-urlencode urlConfig=../../../../../../../../../etc/passwd http://192.168.204.130/administrator/alerts/alertConfigField.php 
```

![image-20240813151633744](./w1r3s-1-0-1/image-20240813151633744.png)

成功读取到文件， 在现在linux系统中，passwd文件里面所有账户的密码都是用x代替的，真正的密码（加密后）放在/etc/shadow中，同样的curl方法，我们改一下参数，看看etc/shadow

![image-20240813151831977](./w1r3s-1-0-1/image-20240813151831977.png)

![image-20240813151837051](./w1r3s-1-0-1/image-20240813151837051.png)

![image-20240813151843318](./w1r3s-1-0-1/image-20240813151843318.png)

分别有三个账号有密码，然后破解hash，得到两个账户的密码，root的密码破解不出来，先使用其他账号登录，后续在提权

![image-20240813152135830](./w1r3s-1-0-1/image-20240813152135830.png)

# 提权

ssh远程连接

![image-20240813152449016](./w1r3s-1-0-1/image-20240813152449016.png)

![image-20240813152458394](./w1r3s-1-0-1/image-20240813152458394.png)

发现具有all权限直接运行bash即可得到root权限

![image-20240813152619868](./w1r3s/image-20240813152619868.png)